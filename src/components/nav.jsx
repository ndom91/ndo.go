import {
  Avatar,
  Navbar,
  Dropdown,
  Text,
  Switch,
  useTheme,
} from '@nextui-org/react'
import { useTheme as useNextTheme } from 'next-themes'
import { useSession, signIn, signOut } from 'next-auth/react'

export default function Nav() {
  const { data: session } = useSession()
  const { setTheme } = useNextTheme()
  const { isDark, type } = useTheme()

  const dropdownAction = (key) => {
    switch (key) {
      case 'theme':
        setTheme(isDark ? 'light' : 'dark')
        break
      case 'logout':
        signOut()
        break
      case 'login':
        signIn('github')
        break
      default:
        console.log('Dropdown.default.onClick', key)
    }
  }

  return (
    <Navbar
      isBordered={false}
      maxWidth="fluid"
      variant={'floating'}
      className="bg-none"
    >
      <Navbar.Brand>
        <Avatar
          squared
          size="lg"
          src="/favicon.png"
          alt="ndo logo"
          width="32"
          height="32"
        />
      </Navbar.Brand>
      <Navbar.Content>
        <Dropdown placement="bottom-right">
          <Dropdown.Trigger>
            <Avatar
              bordered
              size="lg"
              squared
              zoomed
              as="button"
              color="gradient"
              src={session?.user.image ?? '/favicon.png'}
            />
          </Dropdown.Trigger>
          <Dropdown.Menu
            aria-label="User menu actions"
            disabledKeys={['profile']}
            variant="flat"
            onAction={(key) => dropdownAction(key)}
          >
            {session?.user.name ? (
              <Dropdown.Item
                key="profile"
                textValue="Sign in as"
                className="flex "
              >
                <span>Signed in as </span>
                <span className="font-bold">{session?.user.name}</span>
              </Dropdown.Item>
            ) : null}
            <Dropdown.Item
              key="theme"
              textValue="Theme"
              icon={
                <svg
                  height="24"
                  width="24"
                  fill="none"
                  viewBox="0 0 48 48"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M36.0651 12H33.8469V8H36.0651C38.6275 8 40.8289 9.99654 40.9342 12.6746C40.9925 14.1562 41.0309 16.0836 40.9667 18.0752C40.8769 20.8595 38.825 23.022 36.2765 23.5334C33.5332 24.0838 29.0151 25.0163 23.4965 26.2527C22.6026 26.4529 21.9617 27.2574 21.9617 28.1929V40H18V28.1929C18 25.3932 19.9205 22.9565 22.6383 22.3477C28.1911 21.1036 32.7385 20.165 35.5043 19.6101C36.4062 19.4291 36.9824 18.7108 37.0071 17.9451C37.0672 16.08 37.0315 14.2545 36.9756 12.8333C36.9583 12.3932 36.5933 12 36.0651 12Z"
                    fill="#A6CFFF"
                    fillRule="evenodd"
                  />
                  <path
                    d="M35.8658 5.75088C35.7672 4.45537 34.8484 3.52763 33.5548 3.40648C31.5086 3.21484 27.5344 3 20 3C12.4656 3 8.49144 3.21484 6.44518 3.40648C5.15159 3.52763 4.23277 4.45537 4.13419 5.75088C4.06036 6.72113 4 8.09647 4 10C4 11.9035 4.06036 13.2789 4.13419 14.2491C4.23277 15.5446 5.15159 16.4724 6.44519 16.5935C8.49144 16.7852 12.4656 17 20 17C27.5344 17 31.5086 16.7852 33.5548 16.5935C34.8484 16.4724 35.7672 15.5446 35.8658 14.2491C35.9396 13.2789 36 11.9035 36 10C36 8.09647 35.9396 6.72113 35.8658 5.75088Z"
                    fill="#1575E5"
                  />
                  <path
                    d="M17.3696 28.0969C16.1719 28.199 15.337 29.0849 15.2247 30.2816C15.1087 31.5176 15 33.4811 15 36.5C15 39.5189 15.1087 41.4824 15.2247 42.7184C15.337 43.9151 16.1719 44.801 17.3696 44.9031C18.0254 44.959 18.8861 45 20 45C21.1139 45 21.9746 44.959 22.6304 44.9031C23.8281 44.801 24.663 43.9151 24.7753 42.7184C24.8913 41.4824 25 39.5189 25 36.5C25 33.4811 24.8913 31.5176 24.7753 30.2816C24.663 29.0849 23.8281 28.199 22.6304 28.0969C21.9746 28.041 21.1139 28 20 28C18.8861 28 18.0254 28.041 17.3696 28.0969Z"
                    fill="#1575E5"
                  />
                </svg>
              }
              onClick={(e) => e.preventDefault()}
            >
              <div
                className="flex items-center justify-between"
                onClick={(e) => e.preventDefault()}
              >
                {type[0].toUpperCase() + type.slice(1, type.length)}
                <Switch checked={isDark} color="secondary" size="sm" />
              </div>
            </Dropdown.Item>
            <Dropdown.Item
              key="settings"
              textValue="Settings"
              icon={
                <svg
                  height="24"
                  width="24"
                  fill="none"
                  viewBox="0 0 48 48"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M19.9292 4.35457C20.024 4.11921 20.1659 3.90639 20.3799 3.77532C20.8614 3.48047 21.9592 3 24 3C26.0408 3 27.1386 3.48047 27.6201 3.77533C27.8341 3.90639 27.9759 4.11921 28.0708 4.35457C28.3981 5.16658 29.202 7.2333 29.677 9.07765C31.1927 9.67675 32.5945 10.5087 33.84 11.5304C35.646 11.0268 37.8073 10.7023 38.6618 10.585C38.9092 10.5511 39.161 10.5698 39.3795 10.6931C39.8708 10.9706 40.8281 11.6991 41.8485 13.5C42.8689 15.3008 43.0094 16.5097 42.9995 17.0821C42.9952 17.3365 42.8852 17.5681 42.7326 17.7694C42.2059 18.4646 40.8503 20.2085 39.5197 21.5501C39.6401 22.3488 39.7026 23.167 39.7026 24C39.7026 24.833 39.6401 25.6511 39.5197 26.4498C40.8503 27.7914 42.2059 29.5353 42.7326 30.2305C42.8852 30.4319 42.9952 30.6634 42.9995 30.9178C43.0094 31.4902 42.8689 32.6991 41.8485 34.5C40.8281 36.3008 39.8708 37.0293 39.3795 37.3068C39.161 37.4301 38.9092 37.4488 38.6618 37.4149C37.8073 37.2976 35.646 36.9732 33.8401 36.4695C32.5946 37.4912 31.1928 38.3232 29.677 38.9224C29.202 40.7667 28.3981 42.8334 28.0708 43.6454C27.9759 43.8808 27.8341 44.0936 27.6201 44.2247C27.1386 44.5195 26.0408 45 24 45C21.9592 45 20.8614 44.5195 20.3799 44.2247C20.1659 44.0936 20.024 43.8808 19.9292 43.6454C19.6019 42.8334 18.798 40.7667 18.323 38.9224C16.8072 38.3232 15.4054 37.4912 14.1599 36.4695C12.354 36.9732 10.1927 37.2976 9.33823 37.4149C9.09076 37.4488 8.83896 37.4301 8.62055 37.3068C8.12918 37.0293 7.17195 36.3008 6.15154 34.5C5.13112 32.6991 4.99062 31.4902 5.00046 30.9178C5.00484 30.6634 5.11481 30.4319 5.26741 30.2305C5.79414 29.5353 7.14973 27.7914 8.48032 26.4498C8.35989 25.6511 8.29741 24.833 8.29741 24C8.29741 23.167 8.35989 22.3488 8.48033 21.5501C7.14974 20.2085 5.79414 18.4646 5.26741 17.7694C5.11481 17.5681 5.00484 17.3365 5.00046 17.0821C4.99062 16.5097 5.13112 15.3008 6.15154 13.5C7.17195 11.6991 8.12918 10.9706 8.62055 10.6931C8.83896 10.5698 9.09076 10.5511 9.33823 10.585C10.1927 10.7023 12.354 11.0268 14.16 11.5304C15.4055 10.5087 16.8072 9.67675 18.323 9.07765C18.798 7.2333 19.6019 5.16658 19.9292 4.35457Z"
                    fill="#A6CFFF"
                  />
                  <path
                    d="M32 24C32 28.4183 28.4183 32 24 32C19.5817 32 16 28.4183 16 24C16 19.5817 19.5817 16 24 16C28.4183 16 32 19.5817 32 24Z"
                    fill="#1575E5"
                  />
                </svg>
              }
            >
              Settings
            </Dropdown.Item>
            {session?.user ? (
              <Dropdown.Item
                key="logout"
                withDivider
                color="error"
                textValue="Logout"
                icon={
                  <svg
                    height="24"
                    width="24"
                    fill="none"
                    viewBox="0 0 48 48"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M6.70595 4.69844C4.90701 4.91195 3.58469 6.20833 3.32588 8.0013C2.93754 10.6917 2.49219 15.6506 2.49219 24.2451C2.49219 32.0126 2.69428 36.8105 2.89244 39.648C3.04938 41.8954 4.65129 43.6169 6.89276 43.8427C8.98885 44.0538 12.1 44.2451 16.4922 44.2451C20.8844 44.2451 23.9955 44.0538 26.0916 43.8427C28.3331 43.6169 29.935 41.8954 30.0919 39.648C30.2901 36.8105 30.4922 32.0126 30.4922 24.2451C30.4922 16.4776 30.2901 11.6797 30.0919 8.84219C29.935 6.59485 28.3331 4.87333 26.0916 4.64755C23.9955 4.43642 20.8844 4.24512 16.4922 4.24512C11.7491 4.24512 8.64577 4.46821 6.70595 4.69844Z"
                      fill="#A6CFFF"
                    />
                    <path
                      d="M37.8963 33.3948C36.3871 34.6649 34.5228 33.8333 34.4128 31.8567C34.3519 30.7622 34.2987 29.3818 34.2668 27.652C25.7124 27.5655 19.0512 27.3642 15.934 27.2559C14.8489 27.2182 14 26.3216 14 25.229V22.9846C14 21.9084 14.8242 21.0199 15.8922 20.9641C18.9914 20.8022 25.6738 20.4982 34.2664 20.3678C34.2982 18.629 34.3516 17.2423 34.4127 16.1437C34.5227 14.1667 36.3876 13.335 37.8971 14.6054C38.7966 15.3624 39.9055 16.3447 41.2406 17.6079C43.4786 19.7254 44.7633 21.3169 45.4894 22.3822C46.1703 23.381 46.1702 24.6181 45.4893 25.6169C44.7631 26.6821 43.4784 28.2735 41.2406 30.3912C39.9051 31.655 38.7959 32.6377 37.8963 33.3948Z"
                      fill="#1575E5"
                    />
                  </svg>
                }
              >
                Log Out
              </Dropdown.Item>
            ) : (
              <Dropdown.Item
                key="login"
                withDivider
                color="secondary"
                textValue="Login"
                icon={
                  <svg
                    height="24"
                    width="24"
                    fill="none"
                    viewBox="0 0 48 48"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M18.2138 4.45332C16.4148 4.66683 15.0925 5.96321 14.8337 7.75619C14.4454 10.4466 14 15.4055 14 24C14 31.7675 14.2021 36.5654 14.4003 39.4029C14.5572 41.6503 16.1591 43.3718 18.4006 43.5976C20.4967 43.8087 23.6078 44 28 44C32.3922 44 35.5033 43.8087 37.5994 43.5976C39.8409 43.3718 41.4428 41.6503 41.5998 39.4029C41.7979 36.5654 42 31.7675 42 24C42 16.2325 41.7979 11.4346 41.5998 8.59707C41.4428 6.34973 39.8409 4.62821 37.5994 4.40244C35.5033 4.19131 32.3922 4 28 4C23.2569 4 20.1536 4.22309 18.2138 4.45332Z"
                      fill="#A6CFFF"
                    />
                    <path
                      d="M25.8963 33.3948C24.3871 34.6649 22.5228 33.8333 22.4128 31.8567C22.3519 30.7622 22.2987 29.3818 22.2668 27.652C13.7124 27.5655 7.05121 27.3642 3.93399 27.2559C2.84889 27.2182 2 26.3216 2 25.229V22.9846C2 21.9084 2.82418 21.0199 3.89222 20.9641C6.9914 20.8022 13.6738 20.4982 22.2664 20.3678C22.2982 18.629 22.3516 17.2423 22.4127 16.1437C22.5227 14.1667 24.3876 13.335 25.8971 14.6054C26.7966 15.3624 27.9055 16.3447 29.2406 17.6079C31.4786 19.7254 32.7633 21.3169 33.4894 22.3822C34.1703 23.381 34.1702 24.6181 33.4893 25.6169C32.7631 26.6821 31.4784 28.2735 29.2406 30.3912C27.9051 31.655 26.7959 32.6377 25.8963 33.3948Z"
                      fill="#1575E5"
                    />
                  </svg>
                }
              >
                Login
              </Dropdown.Item>
            )}
          </Dropdown.Menu>
        </Dropdown>
      </Navbar.Content>
    </Navbar>
  )
}
